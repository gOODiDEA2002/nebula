# Nebula Framework æµ‹è¯•ç­–ç•¥

> **ç‰ˆæœ¬**: 2.0.1-SNAPSHOT  
> **æœ€åæ›´æ–°**: 2025-01-13

## ğŸ¯ æµ‹è¯•ç›®æ ‡

### è´¨é‡ç›®æ ‡

1. **åŠŸèƒ½æ­£ç¡®æ€§**: æ‰€æœ‰åŠŸèƒ½æŒ‰ç…§éœ€æ±‚è§„æ ¼æ­£ç¡®å®ç°
2. **ç³»ç»Ÿç¨³å®šæ€§**: ç³»ç»Ÿåœ¨å„ç§åœºæ™¯ä¸‹ç¨³å®šè¿è¡Œ
3. **æ€§èƒ½è¾¾æ ‡**: æ»¡è¶³æ€§èƒ½æŒ‡æ ‡è¦æ±‚
4. **å®‰å…¨å¯é **: é€šè¿‡å®‰å…¨æµ‹è¯•ï¼Œæ— ä¸¥é‡æ¼æ´

### è¦†ç›–ç‡ç›®æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | å½“å‰ | çŠ¶æ€ |
|------|------|------|------|
| è¡Œè¦†ç›–ç‡ | â‰¥80% | 84% | âœ… |
| åˆ†æ”¯è¦†ç›–ç‡ | â‰¥70% | 73% | âœ… |
| æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ | â‰¥90% | 91% | âœ… |

## ğŸ“‹ æµ‹è¯•åˆ†å±‚ç­–ç•¥

### 1. å•å…ƒæµ‹è¯• (70%)

**ç›®æ ‡**: æµ‹è¯•æœ€å°å¯æµ‹è¯•å•å…ƒï¼Œç¡®ä¿æ¯ä¸ªç±»ã€æ–¹æ³•æ­£ç¡®å·¥ä½œ

**ç‰¹ç‚¹**:
- å¿«é€Ÿæ‰§è¡Œ (< 10ms/æµ‹è¯•)
- éš”ç¦»å¤–éƒ¨ä¾èµ– (Mock/Stub)
- é«˜è¦†ç›–ç‡

**å·¥å…·**:
- JUnit 5
- Mockito
- AssertJ

### 2. é›†æˆæµ‹è¯• (25%)

**ç›®æ ‡**: æµ‹è¯•æ¨¡å—é—´äº¤äº’ï¼ŒéªŒè¯é›†æˆæ­£ç¡®æ€§

**ç‰¹ç‚¹**:
- æµ‹è¯•çœŸå®ä¾èµ–(æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰)
- ä½¿ç”¨ TestContainers
- ç«¯åˆ°ç«¯åœºæ™¯æµ‹è¯•

**å·¥å…·**:
- Spring Boot Test
- TestContainers
- WireMock

### 3. ç«¯åˆ°ç«¯æµ‹è¯• (5%)

**ç›®æ ‡**: ä»ç”¨æˆ·è§’åº¦æµ‹è¯•å®Œæ•´ä¸šåŠ¡æµç¨‹

**ç‰¹ç‚¹**:
- çœŸå®ç¯å¢ƒæµ‹è¯•
- å…³é”®ä¸šåŠ¡è·¯å¾„éªŒè¯
- è¾ƒæ…¢æ‰§è¡Œ

**å·¥å…·**:
- RestAssured
- Selenium (å¦‚æœ‰Web UI)

## ğŸ”§ æµ‹è¯•å·¥å…·é“¾

### æ ¸å¿ƒæ¡†æ¶

```xml
<!-- JUnit 5 -->
<dependency>
    <groupId>org.junit.jupiter</groupId>
    <artifactId>junit-jupiter</artifactId>
    <version>5.10.1</version>
    <scope>test</scope>
</dependency>

<!-- Mockito -->
<dependency>
    <groupId>org.mockito</groupId>
    <artifactId>mockito-core</artifactId>
    <version>5.7.0</version>
    <scope>test</scope>
</dependency>

<!-- Spring Boot Test -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-test</artifactId>
    <scope>test</scope>
</dependency>
```

### è¾…åŠ©å·¥å…·

| å·¥å…· | ç”¨é€” |
|------|------|
| TestContainers | å®¹å™¨åŒ–æµ‹è¯•ç¯å¢ƒ |
| WireMock | HTTP API Mock |
| Awaitility | å¼‚æ­¥æµ‹è¯• |
| JSONAssert | JSON æ–­è¨€ |
| RestAssured | API æµ‹è¯• |

## ğŸ“ æµ‹è¯•è®¾è®¡åŸåˆ™

### FIRST åŸåˆ™

- **Fast** (å¿«é€Ÿ): å•å…ƒæµ‹è¯•åº”å¿«é€Ÿæ‰§è¡Œ
- **Independent** (ç‹¬ç«‹): æµ‹è¯•ä¹‹é—´ç›¸äº’ç‹¬ç«‹
- **Repeatable** (å¯é‡å¤): æµ‹è¯•ç»“æœå¯é‡å¤
- **Self-Validating** (è‡ªéªŒè¯): æµ‹è¯•æ˜ç¡®pass/fail
- **Timely** (åŠæ—¶): ä¸å¼€å‘åŒæ­¥è¿›è¡Œ

### AAA æ¨¡å¼

```java
@Test
void testMethod() {
    // Arrange (Given) - å‡†å¤‡
    String input = "test";
    
    // Act (When) - æ‰§è¡Œ
    Result result = service.method(input);
    
    // Assert (Then) - æ–­è¨€
    assertThat(result).isNotNull();
}
```

## ğŸ­ Mock ç­–ç•¥

### ä½•æ—¶ä½¿ç”¨ Mock

âœ… **åº”è¯¥ Mock**:
- å¤–éƒ¨æœåŠ¡ (HTTP API, RPC)
- æ•°æ®åº“è®¿é—®
- æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
- æ—¶é—´ä¾èµ– (Clock)
- éšæœºæ•°ç”Ÿæˆ

âŒ **ä¸åº”è¯¥ Mock**:
- ç®€å•çš„ POJO
- çº¯ä¸šåŠ¡é€»è¾‘
- å·¥å…·ç±»æ–¹æ³•

### Mock æœ€ä½³å®è·µ

```java
// æ¨è: ä½¿ç”¨æ³¨è§£
@ExtendWith(MockitoExtension.class)
class ServiceTest {
    @Mock
    private ExternalService externalService;
    
    @InjectMocks
    private ServiceImpl service;
}

// é¿å…: è¿‡åº¦ Mock
// âŒ ä¸è¦ Mock æ‰€æœ‰ä¾èµ–
// âœ… åª Mock å¿…è¦çš„å¤–éƒ¨ä¾èµ–
```

## ğŸ“Š æµ‹è¯•æ‰§è¡Œç­–ç•¥

### æœ¬åœ°å¼€å‘

```bash
# å¿«é€Ÿæµ‹è¯• (ä»…å•å…ƒæµ‹è¯•)
mvn test -DexcludeGroups=integration

# å®Œæ•´æµ‹è¯• (åŒ…æ‹¬é›†æˆæµ‹è¯•)
mvn test

# ç‰¹å®šæ¨¡å—æµ‹è¯•
mvn test -pl infrastructure/data/nebula-data-cache
```

### CI/CD Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æäº¤ä»£ç    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å•å…ƒæµ‹è¯•     â”‚ (æ¯æ¬¡æäº¤)
â”‚  < 5åˆ†é’Ÿ     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é›†æˆæµ‹è¯•     â”‚ (æ¯æ¬¡æäº¤åˆ°main)
â”‚  < 15åˆ†é’Ÿ    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  E2Eæµ‹è¯•      â”‚ (æ¯æ—¥/æ¯å‘¨)
â”‚  < 30åˆ†é’Ÿ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› æµ‹è¯•æ•°æ®ç®¡ç†

### æµ‹è¯•æ•°æ®åŸåˆ™

1. **æœ€å°åŒ–**: åªåˆ›å»ºå¿…è¦çš„æµ‹è¯•æ•°æ®
2. **ç‹¬ç«‹æ€§**: æ¯ä¸ªæµ‹è¯•ä½¿ç”¨ç‹¬ç«‹æ•°æ®
3. **å¯è¯»æ€§**: æµ‹è¯•æ•°æ®è¯­ä¹‰æ˜ç¡®
4. **æ¸…ç†**: æµ‹è¯•åæ¸…ç†æ•°æ®

### æµ‹è¯•æ•°æ®ç¤ºä¾‹

```java
// æ¨è: ä½¿ç”¨ Builder æ¨¡å¼
@Test
void testCreateUser() {
    User user = User.builder()
        .username("testuser")
        .email("test@example.com")
        .build();
    
    User created = userService.create(user);
    
    assertThat(created.getId()).isNotNull();
}

// æ¨è: ä½¿ç”¨æµ‹è¯•æ•°æ®å·¥å‚
User user = TestDataFactory.createUser();
```

## ğŸš€ æŒç»­æ”¹è¿›

### æµ‹è¯•åº¦é‡

ç›‘æ§ä»¥ä¸‹æŒ‡æ ‡:
- æµ‹è¯•è¦†ç›–ç‡
- æµ‹è¯•æ‰§è¡Œæ—¶é—´
- æµ‹è¯•å¤±è´¥ç‡
- ç¼ºé™·é€ƒé€¸ç‡

### å®šæœŸå®¡æŸ¥

- **æ¯å‘¨**: å®¡æŸ¥å¤±è´¥æµ‹è¯•
- **æ¯æœˆ**: å®¡æŸ¥æµ‹è¯•è¦†ç›–ç‡
- **æ¯å­£åº¦**: ä¼˜åŒ–æµ‹è¯•å¥—ä»¶

---

**æµ‹è¯•æ˜¯è´¨é‡çš„åŸºçŸ³** - Nebula Framework

